<html>
  <head>
    <title>Evolution Simulator</title>
    <script type="text/javascript" src="https://www.google.com/jsapi?autoload={'modules':[{'name':'visualization','version':'1','packages':['corechart']}]}"></script>
    <script type="text/javascript" src="evolution.js"></script>
    <style type="text/css">
#universe, #controls, #chart {
  display: table;
  margin: 1em auto;
}
#universe {
  border: 2px solid red;
}
#controls a {
  margin: 0 1em;
}
    </style>
  </head>
  <body>
    <canvas id="universe" height="400" width="600"></canvas>
    <div id="controls">
      <a href="#" onclick="stop();return false">stop</a>
      <a href="#" onclick="start();return false">start</a>
      <a href="#" onclick="restart();return false">restart</a>
    </div>
    <div id="chart"></div>
    <script type="text/javascript">
      var u;
      function makeUniverse() {
        u = new Universe("universe", { callback: collectData } );
      }
      makeUniverse();
      var evoData = {
        names: [ 'Plant', 'Herbivore', 'Carnivore' ],
        rows: []
      };
      function collectData(u) {
        var stats = u.describe();
        var counts = { Plant: 0, Herbivore: 0, Carnivore: 0 };
        for ( var i = 0; i < stats.length; i += 1 ) {
          description = stats[i];
          counts[description['type']] += 1;
        }
        var row = [ evoData.rows.length + 1, counts.Plant, counts.Herbivore, counts.Carnivore ];
        evoData.rows.push(row);
        drawChart();
      }
      function restart() {
        u.stop();
        u.erase();
        makeUniverse();
        u.run();
      }
      function stop() {
        u.stop();
      }
      function start() {
        u.start();
      }

      google.load('visualization', '1', {packages: ['corechart']});
      google.setOnLoadCallback(drawChart);

      function drawChart() {

        var data = new google.visualization.DataTable();
        data.addColumn( 'number', 'X' );
        for ( var i = 0; i < evoData.names.length; i += 1 ) {
          data.addColumn( 'number', evoData.names[i] );
        }
        data.addRows(evoData.rows);

        var options = {
          width: 1000,
          height: 563,
          hAxis: {
            title: 'Time'
          },
          vAxis: {
            title: 'Population'
          }
        };

        var chart = new google.visualization.LineChart(
          document.getElementById('chart'));

        chart.draw(data, options);

      }
    </script>
  </body>
</html>